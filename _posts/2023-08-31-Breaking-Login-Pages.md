---
title: Breaking Login Pages
author: Cognisys
date: 2023-08-31 5:00:00 +0100
categories: [Web Application Pentesting, Authentication, ]
tags: [Application security, Authentication, Broken Authentication, Web Pentesting]
image:
  path: https://github-production-user-asset-6210df.s3.amazonaws.com/25560539/264714259-fe9f7eac-1e7a-4164-b72a-f2d2483140b1.png
  alt: 
render_with_liquid: false
toc: false
---
We daily come across login pages as normal internet users, but as a security guy, one is always curious to find ways to bypass the login panels. Hi everyone we hope you all are doing great. In this blog, we will discuss the various methods to bypass the login panels. 

Web applications have become integral to our daily lives, from online shopping and banking to social media and business applications. They handle sensitive user data and perform critical functions, making them attractive targets for cybercriminals. If not properly secured, web applications can be exploited to steal user data, compromise accounts, spread malware, deface websites, and even launch attacks against users' devices. Web application security is crucial to protect both users and the reputation of the organisations behind these applications.

Login panels, also known as authentication mechanisms, are points of entry that protect access to various online services. They are critical components of web applications, as they prevent unauthorised access and maintain the privacy and security of user data. However, their importance also makes them a prime target for attackers.

Threat actors are drawn to login panels because compromising them can grant unauthorised access to sensitive information and functionality. Breaching a login panel can lead to data breaches, identity theft, financial fraud, and more. Given the high value of user accounts, attackers employ a wide range of techniques to bypass login panels and gain access.

As a security researcher and web application pentester, understanding the vulnerabilities and attack methods targeting login panels is essential. By identifying and addressing these vulnerabilities, you contribute to improving the overall security of web applications and help protect users' confidential information.

In this blog, we'll explore further the consequences of compromised login panels and how they fit into the larger landscape of web application security. 

Techniques to bypass Login pages:

1. SQL Injection
2. Response Manipulation
3. Forced Browsing
4. Brute Forcing Common Credentials
5. Credential Stuffing 

Let's dive even deeper into each of the techniques with comprehensive explanations:

![memes](https://github.com/CognisysGroup/cognisysgroup.github.io/assets/25560539/fe300605-8145-486b-9437-a4040469a18a)

### 1. SQL Injection

SQL Injection is a vulnerability in an application's handling of user-supplied data. By injecting malicious SQL queries, threat actors can manipulate database queries and potentially gain unauthorised access to sensitive data or bypass login mechanisms.

In the provided request snippet, the attacker uses a classic SQL Injection technique. The username input `' OR '1'='1'-- ` is crafted to make the SQL query always return true, effectively bypassing the authentication process. The double hyphen `-- ` signifies the start of a comment, effectively nullifying the rest of the query.

**Request Snippet:**
```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
...
username='+OR+'1'='1'--+-&password=anything
```

**Backend Code Vulnerabilities**

SQL Injection often exploits weaknesses in the backend code. Here's an example of vulnerable PHP code:

```php
// Vulnerable PHP Code
$username = $_POST['username'];
$password = $_POST['password'];
$query = "SELECT * FROM users WHERE username='$username' AND password='$password'";
```

In this code, the application directly inserts user input (`$username` and `$password`) into the SQL query without proper sanitisation or parameterisation. This allows threat actors to modify the existing queries to always return `true`

**Mitigation:**

- Utilise parameterised queries or prepared statements, which separate user input from SQL commands. Here's an example in PHP: 

```php
$username = $_POST['username'];
$password = $_POST['password'];
$stmt = $pdo->prepare("SELECT * FROM users WHERE username=:username AND password=:password");
$stmt->bindParam(':username', $username);
$stmt->bindParam(':password', $password);
$stmt->execute();
```

- Implement strict input validation to allow only expected data formats. Reject input that doesn't adhere to these formats.

### 2. Response Manipulation

Response manipulation is an attack technique where a threat actor modifies or manipulates the responses generated by a web application to achieve unauthorised access. This manipulation can take several forms, such as altering the content of HTTP responses and tampering with HTTP headers. The fundamental vulnerability that enables response manipulation is often rooted in inadequate client-side validation.

**Request Snippet:**
```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
...
username=admin&password=admin
```

**Response Snippet:**
```http
HTTP/1.1 200 OK
...
{
"success": true
}
```

**Mitigation:**

- It is important to implement basic authentication checks on the server side.
- Implement proper session management based on cookie-based authentication mechanisms.

In conclusion, response manipulation is an attack vector that exploits both front-end and back-end vulnerabilities. Understanding how attackers manipulate responses and addressing the underlying backend causes is crucial for building secure web applications that can withstand such advanced threats.

### 3. Forced Browsing

Typically, when users venture into restricted areas without proper authentication, web applications respond with HTTP 302 Found redirections, steering users towards the login page. However, in certain scenarios, the HTTP response takes an unexpected turn. Instead of merely redirecting, the response also carries a payload of sensitive information, including the HTML structure of the dashboard or other privileged sections.

**Request Snippet:**

```http
POST /admin-panel HTTP/1.1
Host: example.com
...
```

**HTML Response with Unintended Disclosure:**

```http
HTTP/1.1 302 Found
Server: Microsoft-IIS/10.0
Location: /login

<html>
<title> Dashboard </title>
<!-- Meta tags, scripts, and sensitive information here -->
...
```

**Mitigating Forced Browsing Risks:**

To mitigate the risks associated with forced browsing vulnerabilities, consider implementing the following measures:

 * Customise error handling to prevent the inadvertent exposure of sensitive information. Configure your application to deliver generic error messages instead of detailed HTML content.
 * Implement robust session management practices, ensuring that session tokens or identifiers are never exposed in HTTP responses. Utilise secure HTTP-only cookies and regenerate session tokens upon login.

In conclusion, while HTTP 302 redirections are an essential web application mechanism to redirect users to relevant endpoints, the inadvertent exposure of sensitive information content in the response body presents a potential risk. By adopting a holistic security approach that includes secure session management, error handling, and robust monitoring, web applications can effectively mitigate the risks associated with forced browsing vulnerabilities and enhance their overall security posture.

### 4. Brute Forcing Common Credentials

Brute Forcing and Username Enumeration are techniques used by attackers to gain unauthorised access to user accounts by systematically guessing login credentials. Brute Forcing involves trying every possible combination of usernames and passwords until the correct one is found, while Username Enumeration focuses on discovering valid usernames before launching a brute-force attack. These attacks are made possible by exploiting vulnerabilities in the login page and backend systems.

**Request Snippet:**
```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
...
username=admin&password=password1
```

**Credential Dictionaries**

Attackers start by assembling extensive dictionaries of commonly used passwords and usernames. These dictionaries are often curated from publicly available sources or obtained from previous data breaches. These lists may also include permutations, combinations, and variations of known passwords and usernames.

```
Examples of Common Passwords:
- 123456
- password
- qwerty
```

```
Examples of Common Usernames:
- admin
- user
- root
```

If there is a username enumeration possible on the target a threat actor just needs to do a password spray attack.

Password spraying is a stealthier approach to brute-force attacks. Instead of bombarding a single account with numerous password attempts (which might trigger account lockout mechanisms), attackers choose a few common passwords and test them against a large number of usernames.

```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
...
username=user1&password=123456
```

**Causes that make Brute Forcing Successful**

- **Weak Passwords**: Many users choose easily guessable passwords like '123456' or 'password,' making it easier for attackers to succeed.
- **Password Reuse**: Users often reuse passwords across multiple accounts. Attackers who obtain credentials from one source can use them to compromise other accounts.
- **Lack of Account Lockout Policies**: Inadequate or absent account lockout policies allow attackers to make numerous login attempts without repercussions.

**Mitigation:**

To mitigate the risk of Brute Forcing Common Credentials:

- Implement account lockout policies and rate limiting to restrict the number of login attempts per user and IP address. After a certain number of failed attempts, temporarily lock or delay login requests.
- Educate users about password security and encourage them to create strong, unique passwords. Consider enforcing password policies that mandate complexity, length, and regular changes.
- Implement MFA to add an additional layer of security. Even if attackers obtain valid credentials, they won't be able to access accounts without the second authentication factor.

By understanding the causes and consequences of Brute Forcing Common Credentials and implementing these mitigation strategies, organisations can significantly enhance their security posture and protect user accounts from this prevalent attack vector.

### 5. Credential Stuffing

Credential Stuffing, especially when enhanced by Open Source Intelligence (OSINT) techniques, represents a sophisticated and potent threat to online security. This attack leverages previously stolen username and password pairs, which are often obtained from various sources such as data breaches. Threat actors combine these credentials with additional information gathered through OSINT to maximise their success in compromising accounts.

- **Acquisition of Credential Lists**: Attackers amass extensive lists of username and password pairs that have been compromised in previous data breaches. These lists are often traded on underground forums, sold on dark web marketplaces, or distributed among cybercriminal communities.

```
Example of Compromised Credentials:
Username: john.doe@email.com
Password: password123
```

-  **Credential Leakage via JavaScript**: Credential Leakage via JavaScript is a sophisticated security issue where sensitive information, such as login credentials or access tokens, is inadvertently exposed in client-side JavaScript code. This exposure can occur due to insecure coding practices, improper error handling, or inadequate protection of sensitive data within the frontend codebase.

**Open Source Intelligence (OSINT)**

Attackers elevate their attacks by incorporating OSINT. They gather supplementary information about potential victims from publicly available sources, such as social media, public records, or corporate websites. This information may include personal details, interests, or patterns of online behaviour.

```
OSINT Information Gathering:
- Full Name: John Doe
- Birthdate: 01/15/1985
- LinkedIn Profile: linkedin.com/in/johndoe
```

- **Frequent Password Rotations**: To fortify defences against credential stuffing, organisations can implement policies requiring users to change their passwords regularly. Frequent password rotations make it challenging for attackers to use stolen credentials effectively.
- **Multi-Factor Authentication (MFA)**: Implementing MFA adds an extra layer of security. Even if attackers acquire valid usernames and passwords, they would still need the second authentication factor to access accounts.

**Causes Behind Credential Stuffing**

- **Password Reuse**: Users often reuse passwords across multiple online services. Once an attacker acquires a set of credentials from one breach, they can systematically test them across various services where users have reused the same passwords.
- **Availability of OSINT**: OSINT sources, such as social media and publicly accessible data, provide attackers with a wealth of additional information about potential victims. This information enables attackers to craft more convincing phishing attacks and tailor their credential-stuffing attempts.
- **Limited User Awareness**: Many users are unaware of the risks associated with password reuse and the importance of using unique passwords for each online service. This lack of awareness contributes to the success of credential-stuffing attacks.

**Mitigation:**

To effectively mitigate the risk of Credential Stuffing:

- **User Education**: Raise user awareness about the dangers of password reuse and the importance of creating unique, strong passwords for each online service.
- **Account Lockout and Monitoring**: Implement account lockout policies and actively monitor login patterns for unusual activities. Rapidly detect and block multiple login attempts.
- **Password Policies**: Enforce password policies that mandate complexity, length, and frequent rotations. Discourage or prevent password reuse.
- **Multi-Factor Authentication (MFA)**: Encourage or require users to enable MFA wherever possible to add an extra layer of security.
- **OSINT Awareness**: Organisations should be vigilant about the amount of information they make publicly available. Minimise the potential for attackers to gather OSINT by restricting the accessibility of sensitive information.

Credential Stuffing, especially when combined with OSINT, poses a significant challenge to cybersecurity. By comprehensively understanding this threat and implementing these mitigation strategies, organisations can better protect their users and data from this sophisticated attack vector.

### References:

* [https://owasp.org/www-community/attacks/SQL_Injection](https://owasp.org/www-community/attacks/SQL_Injection)
* [https://book.hacktricks.xyz/pentesting-web/login-bypass](https://book.hacktricks.xyz/pentesting-web/login-bypass)
* [https://en.wikipedia.org/wiki/Open-source_intelligence](https://en.wikipedia.org/wiki/Open-source_intelligence)
* [https://owasp.org/www-community/attacks/Credential_stuffing](https://owasp.org/www-community/attacks/Credential_stuffing)
* [https://owasp.org/www-community/attacks/Brute_force_attack](https://owasp.org/www-community/attacks/Brute_force_attack)
* [https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication](https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication)
